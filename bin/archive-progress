#!/usr/bin/env bash
# Archive progress.md to ~/.handovers/{project}/{timestamp}.md

set -euo pipefail

# Find progress.md in current directory
if [[ ! -f "progress.md" ]]; then
  exit 0 # Nothing to archive
fi

# Get project name from git or directory
if git rev-parse --show-toplevel &>/dev/null; then
  proj=$(basename "$(git rev-parse --show-toplevel)")
else
  proj=$(basename "$PWD")
fi

# Create archive directory
archive_dir="$HOME/.handovers/$proj"
mkdir -p "$archive_dir"

# Archive with timestamp
timestamp=$(date +%Y-%m-%d_%H-%M-%S)
dest="$archive_dir/$timestamp.md"

cp progress.md "$dest"
echo "Archived progress.md to $dest"
