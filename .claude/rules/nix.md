---
paths: {nix,ansible,config}/**
---

# Nix Configuration Rules

## Nix-First Development

**Nix Home Manager is the primary configuration system.** The Ansible/symlink approach in `config/` is legacy, kept for machines without Nix.

Dont make edits to ansible files unless specifically requested to do so.

When making changes to shell, editor, or tool configuration:

| Config Type                       | Edit Here (Primary)                                 | Legacy (avoid unless asked) |
| --------------------------------- | --------------------------------------------------- | --------------------------- |
| Zsh (aliases, functions, exports) | `nix/home/shared/zsh.nix`                           | `config/zsh/zshrc`          |
| Git config                        | `config/git/gitconfig` (symlinked by both)          | -                           |
| Tmux                              | `nix/home/shared/tmux.nix`                          | `config/tmux/`              |
| Starship                          | `config/starship/starship.toml` (symlinked by both) | -                           |
| Neovim                            | `config/nvim/` (symlinked by both)                  | -                           |
| Ghostty                           | `nix/home/shared/ghostty.nix`                       | `config/ghostty/`           |
| Window managers (Niri, Hyprland)  | `nix/home/linux/niri/`, `nix/home/nixos/hyprland/`  | -                           |

**Key principle:** If a config is generated by Nix (like zsh, ghostty), edit the `.nix` file. If it's symlinked via `mkOutOfStoreSymlink`, edit the file in `config/`.

## After every change

- Run `just check` - formats, lints, and evaluates config

## Only when requested

- `just dry` - full build test (NixOS only)
- `just switch` - apply changes
